<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NameFlux — генератор никнеймов</title>
    <!-- Telegram Web App SDK (для адаптации под тему и возможности закрыть) -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--tg-theme-bg-color, #f5f7fa);
            color: var(--tg-theme-text-color, #1c1e24);
            padding: 16px;
            transition: background 0.2s, color 0.2s;
        }

        .container {
            max-width: 400px;
            width: 100%;
            background: var(--tg-theme-secondary-bg-color, #ffffff);
            border-radius: 28px;
            box-shadow: 0 20px 35px -8px rgba(0, 0, 0, 0.15);
            padding: 32px 24px;
            text-align: center;
            transition: background 0.2s;
        }

        h1 {
            font-size: 2.2rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            margin-bottom: 8px;
            color: var(--tg-theme-text-color, #1c1e24);
        }

        .subtitle {
            font-size: 0.95rem;
            opacity: 0.7;
            margin-bottom: 32px;
            color: var(--tg-theme-hint-color, #6d7885);
        }

        /* блок с ником */
        .nickname-box {
            background: var(--tg-theme-bg-color, #f0f3f8);
            border-radius: 40px;
            padding: 20px 16px;
            margin-bottom: 32px;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-word;
            border: 1px solid var(--tg-theme-section-separator-color, rgba(0,0,0,0.05));
            transition: all 0.3s ease;
        }

        .nickname {
            font-size: 2rem;
            font-weight: 600;
            line-height: 1.3;
            color: var(--tg-theme-text-color, #1c1e24);
            transition: opacity 0.25s;
        }

        .nickname.placeholder {
            opacity: 0.35;
            font-weight: 400;
            font-size: 1.4rem;
        }

        /* спиннер (появляется вместо ника при генерации) */
        .loader {
            display: none;
            width: 48px;
            height: 48px;
            border: 4px solid var(--tg-theme-hint-color, #b0b8c5);
            border-top: 4px solid var(--tg-theme-button-color, #40a7e3);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* кнопка */
        .generate-btn {
            background: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 60px;
            padding: 18px 32px;
            font-size: 1.2rem;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 10px 20px -5px rgba(64, 167, 227, 0.3);
            transition: transform 0.15s, background 0.2s, box-shadow 0.2s;
            margin-bottom: 16px;
        }

        .generate-btn:active {
            transform: scale(0.96);
        }

        .generate-btn:disabled {
            opacity: 0.65;
            transform: scale(1);
            box-shadow: none;
            pointer-events: none;
        }

        /* пульсация во время генерации */
        .generate-btn.generating {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(64, 167, 227, 0.7); }
            70% { box-shadow: 0 0 0 12px rgba(64, 167, 227, 0); }
            100% { box-shadow: 0 0 0 0 rgba(64, 167, 227, 0); }
        }

        /* прогресс-бар (3 секунды) */
        .progress-container {
            width: 100%;
            height: 6px;
            background: var(--tg-theme-hint-color, #dce1e9);
            border-radius: 10px;
            overflow: hidden;
            margin: 16px 0 8px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: var(--tg-theme-button-color, #40a7e3);
            border-radius: 10px;
            transition: width 0.1s linear;
        }

        .progress-container.active {
            opacity: 1;
        }

        /* статус (например, ошибка не нужна, но можно показывать "генерация...") */
        .status {
            font-size: 0.9rem;
            color: var(--tg-theme-hint-color, #949eb0);
            min-height: 24px;
        }

        .hint {
            font-size: 0.8rem;
            color: var(--tg-theme-hint-color, #949eb0);
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>NameFlux</h1>
        <div class="subtitle">⚡ генератор уникальных ников</div>

        <!-- Отображение ника и лоадер (скрыт) -->
        <div class="nickname-box">
            <div id="nicknameDisplay" class="nickname placeholder">никнейм</div>
            <div id="loader" class="loader"></div>
        </div>

        <!-- Прогресс генерации (появляется во время ожидания) -->
        <div id="progressContainer" class="progress-container">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <!-- Кнопка действия -->
        <button id="generateBtn" class="generate-btn">Сгенерировать</button>

        <!-- Маленький статус (например, "готово" или подсказка) -->
        <div id="statusMessage" class="status"></div>
        <div class="hint">нажми — и через 3 секунды получишь ник</div>
    </div>

    <script>
        // --- Инициализация Telegram WebApp ---
        const tg = window.Telegram?.WebApp;
        if (tg) {
            tg.expand(); // растянуть на весь экран
            tg.enableClosingConfirmation(); // предупреждение при закрытии (опционально)
            // Цвета подхватятся автоматически через CSS переменные
        }

        // --- Элементы DOM ---
        const nicknameEl = document.getElementById('nicknameDisplay');
        const loaderEl = document.getElementById('loader');
        const generateBtn = document.getElementById('generateBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progressBar = document.getElementById('progressBar');
        const statusEl = document.getElementById('statusMessage');

        // --- База данных никнеймов (можно расширить) ---
        const nicknames = [
            "ShadowPulse", "NeonRider", "CyberPanda", "FluxMaster", "LunarEcho",
            "QuantumFox", "BlazeStriker", "MysticWave", "SolarWarden", "FrostByte",
            "VenomSpike", "ThunderNova", "EclipseWolf", "VelocityX", "PhantomSpire",
            "CrimsonFang", "ApexVortex", "NebulaDrift", "OmegaRift", "PixelWraith",
            "StormChaser", "DarkHarbinger", "BlinkFusion", "SavageNova", "GlitchWarden"
        ];

        // --- Состояние ---
        let isGenerating = false;
        let intervalId = null;
        let timeoutId = null;
        let progress = 0;

        // --- Функция получения случайного ника ---
        function getRandomNickname() {
            const randomIndex = Math.floor(Math.random() * nicknames.length);
            return nicknames[randomIndex];
        }

        // --- Сброс интерфейса в исходное состояние (после генерации или ошибки) ---
        function resetUI() {
            // Остановить все таймеры
            if (intervalId) {
                clearInterval(intervalId);
                intervalId = null;
            }
            if (timeoutId) {
                clearTimeout(timeoutId);
                timeoutId = null;
            }

            // Скрыть прогресс и лоадер
            progressContainer.classList.remove('active');
            loaderEl.style.display = 'none';
            nicknameEl.style.display = 'block'; // убедиться, что ник виден

            // Разблокировать кнопку и убрать анимацию пульсации
            generateBtn.disabled = false;
            generateBtn.classList.remove('generating');

            // Сброс прогресс-бара
            progress = 0;
            progressBar.style.width = '0%';

            isGenerating = false;
        }

        // --- Функция запуска генерации ---
        function startGeneration() {
            if (isGenerating) return;

            // Сбросить на всякий случай (предыдущие таймеры)
            if (intervalId) clearInterval(intervalId);
            if (timeoutId) clearTimeout(timeoutId);

            isGenerating = true;

            // Заблокировать кнопку, добавить пульс
            generateBtn.disabled = true;
            generateBtn.classList.add('generating');

            // Спрятать текущий ник, показать лоадер
            nicknameEl.style.display = 'none';
            loaderEl.style.display = 'block';

            // Показать прогресс-бар, сбросить его
            progressContainer.classList.add('active');
            progress = 0;
            progressBar.style.width = '0%';

            statusEl.textContent = 'Генерация...';

            // Таймер прогресса (обновление каждые 30 мс для плавности)
            const startTime = Date.now();
            const duration = 3000; // 3 секунды

            intervalId = setInterval(() => {
                const elapsed = Date.now() - startTime;
                progress = Math.min((elapsed / duration) * 100, 100);
                progressBar.style.width = progress + '%';

                if (progress >= 100) {
                    clearInterval(intervalId);
                    intervalId = null;
                }
            }, 30);

            // Таймер окончания генерации (3 сек)
            timeoutId = setTimeout(() => {
                // Выбрать новый ник
                const newNick = getRandomNickname();
                nicknameEl.textContent = newNick;
                nicknameEl.classList.remove('placeholder'); // убираем полупрозрачность

                // Переключить видимость: скрыть лоадер, показать ник
                loaderEl.style.display = 'none';
                nicknameEl.style.display = 'block';

                // Скрыть прогресс-бар
                progressContainer.classList.remove('active');

                // Разблокировать кнопку, убрать пульс
                generateBtn.disabled = false;
                generateBtn.classList.remove('generating');

                // Сообщение
                statusEl.textContent = '✅ Готово!';

                // Сбросить флаг
                isGenerating = false;
                timeoutId = null;
                intervalId = null;
            }, duration);
        }

        // --- Обработчик клика на кнопку ---
        generateBtn.addEventListener('click', startGeneration);

        // --- Дополнительно: поддержка темы Telegram (уже через CSS переменные) ---
        // Если нужно явно сообщить Telegram, что приложение готово
        if (tg) {
            tg.ready();
        }

        // --- Инициализация: показать случайный ник при первом запуске? Можно сразу сгенерировать первый раз, но лучше оставить плейсхолдер.
        // Раскомментируй, если хочешь сразу показать какой-то ник:
        // setTimeout(() => {
        //     nicknameEl.textContent = getRandomNickname();
        //     nicknameEl.classList.remove('placeholder');
        // }, 100);
    </script>
</body>
  </html>
